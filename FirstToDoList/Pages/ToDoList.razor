@page "/todolist"
@using FirstToDoList.Services;
@using FirstToDoListBlazor.Model;
@inject ToDoServices ToDoServices;


<PageTitle>TODO List</PageTitle>

<h1>TODO List</h1>

<p role="status">Current Lista:</p>
<div class="col">
    <button class="btn btn-primary" @onclick="AddTask">Add a Task</button>
    <input type="text" id="task" name="task" @bind="task">
</div>
<div class="col col-md-4">

<div class="col">
    @foreach (string task in model.ToDoList)
    {
        @if(!string.IsNullOrWhiteSpace(task))
        {
        <div class="col">
            <button class="btn btn-outline-success" @onclick="SaveTask" >Save</button>
            <button class="btn btn-outline-secondary" >Done</button>
            <button class="btn btn-outline-danger" >Remove</button>
            <span class=""> @task</span>
        </div>
        }
    }
</div>
</div>

@code {
    public ToDoListModel model = new();

    string task;

    private async Task AddTask()
    {
        if(!model.ToDoList.Contains(task))
        {
            model.ToDoList.Add(task);
        }
        await ToDoServices.Save(model);
        task = "";
    private void RemoveTask(string task)
    {
        model.ToDoList.Remove(task);
        ToDoServices.Save(model);

    }    
    private void SaveTask()
    {
        model.ToDoList.Add(task);
    }
    protected override void OnInitialized()
    {
        ToDoServices.Load(model);
    }

}
